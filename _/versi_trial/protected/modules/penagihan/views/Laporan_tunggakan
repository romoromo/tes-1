<?php

class Laporan_tunggakanController extends Controller
{
	public function actionIndex()
	{
		$data['rek'] = Yii::app()->db->createCommand('
			SELECT
			*
			FROM
			TBLREKENING
			WHERE
			TBLREKENING_REKPAJAK = 1
			AND TBLREKENING_REKPAD = 1
			AND TBLREKENING_REKJENIS = 0
			ORDER BY
			TBLREKENING_REKPENDAPATAN,
			TBLREKENING_REKPAD,
			TBLREKENING_REKPAJAK,
			TBLREKENING_REKAYAT,
			TBLREKENING_REKJENIS
			')->queryAll();
		$this->renderPartial('index', array('data'=>$data));
	}

	public function getData()
	{
		$namaTBL = '';
		$tahunpjk = isset($_REQUEST['TBLPENDATAAN_THNPAJAK']) && !empty($_REQUEST['TBLPENDATAAN_THNPAJAK']) ? (int)$_REQUEST['TBLPENDATAAN_THNPAJAK'] : '';
		$bulanpjk = isset($_REQUEST['TBLPENDATAAN_BLNPAJAK']) && !empty($_REQUEST['TBLPENDATAAN_BLNPAJAK']) ? (int)$_REQUEST['TBLPENDATAAN_BLNPAJAK'] : '';

		$wherethnpajak = $tahunpjk!=0 ? (' AND TBLPENDATAAN_THNPAJAK='.$tahunpjk) : '';
		$whereblnpajak = $bulanpjk!=0 ? (' AND TBLPENDATAAN_BLNPAJAK='.$bulanpjk) : '';

		$rek = isset($_REQUEST['rekening']) && !empty($_REQUEST['rekening']) ? $_REQUEST['rekening'] : '';
		switch ( $rek ) {
			case '4.1.1.1.0':
			$namaTBL = 'TBLDAFTHOTEL';
			$AYAT = '1';
			break;
			
			case '4.1.1.2.0':
			$namaTBL = 'TBLDAFTRMAKAN';
			$AYAT = '2';
			break;
			
			case '4.1.1.3.0':
			$namaTBL = 'TBLDAFTHIBURAN';
			$AYAT = '3';
			break;
			
			case '4.1.1.4.0':
			$namaTBL = 'TBLDAFTREKLAME';
			$AYAT = '4';
			break;
			
			case '4.1.1.7.0':
			$namaTBL = 'TBLDAFTPARKIR';
			$AYAT = '7';
			break;
			
			case '4.1.1.8.0':
			$namaTBL = 'TBLDAFTTANAH';
			$AYAT = '8';
			break;
			
			case '4.1.1.9.0':
			$namaTBL = 'TBLDAFTBURUNG';
			$AYAT = '9';
			break;
			
			default:
			$namaTBL = 'TBLDAFTHOTEL';
			break;
		}
		$sql = "
		SELECT
		TBLDAFTAR.TBLDAFTAR_GOLONGAN
		,TBLDAFTAR.TBLDAFTAR_NOPOK
		,TBLDAFTAR.TBLKECAMATAN_IDBADANUSAHA
		,TBLDAFTAR.TBLKELURAHAN_IDBADANUSAHA
		,TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA
		,TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=1  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  JANUARI,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=2  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  FEBRUARI,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=3  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  MARET,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=4  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  APRIL,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=5  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  MEI,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=6  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  JUNI,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=7  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  JULI,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=8  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  AGUSTUS,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=9  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  SEPTEMBER,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=10  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  OKTOBER,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=11  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  NOVEMBER,
		sum(CASE  WHEN TBLPENDATAAN_BLNPAJAK=12  THEN NVL(" . $namaTBL . "_OMSETPAJAK,0) ELSE 0 END) AS  DESEMBER
		
		FROM TBLDAFTAR
		Inner Join " . $namaTBL . " ON TBLDAFTAR.TBLDAFTAR_NOPOK = " . $namaTBL . ".TBLDAFTAR_NOPOK
		
		WHERE
		" . $namaTBL . "_REKPENDAPATAN = 4
		AND " . $namaTBL . "_REKPAD = 1
		AND " . $namaTBL . "_REKPAJAK = 1
		AND " . $namaTBL . "_REKAYAT = ".$AYAT."
		".$wherethnpajak."
		".$whereblnpajak."
		and " . $namaTBL . "." . $namaTBL . "_ISJNSPENETAPAN='S'

		group by TBLDAFTAR.TBLDAFTAR_GOLONGAN
		,TBLDAFTAR.TBLDAFTAR_NOPOK
		,TBLDAFTAR.TBLKECAMATAN_IDBADANUSAHA
		,TBLDAFTAR.TBLKELURAHAN_IDBADANUSAHA
		,TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA
		,TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT

		ORDER BY  TBLDAFTAR.TBLKECAMATAN_IDBADANUSAHA
		,TBLDAFTAR.TBLKELURAHAN_IDBADANUSAHA
		,TBLDAFTAR.TBLDAFTAR_NOPOK
		";
		return $data = Yii::app()->db->createCommand( $sql )->queryAll();
	}

	public function actionCari()
	{
		$TBLREKENING_KODE = $_REQUEST['TBLREKENING_KODE'];
		$tahun = substr($_REQUEST['tahun'], -2);
		$nopok = $_REQUEST['nopok'];

		$AYAT = $_REQUEST['TBLREKENING_KODE'];

		if($AYAT=='4.1.1.1.0'){
			$data['judul'] = 'PAJAK HOTEL';
			$hotel="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTHOTEL.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHOTEL.TBLDAFTAR_GOLONGAN,
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK,
			TBLDAFTHOTEL.TBLKECAMATAN_ID,
			TBLDAFTHOTEL.TBLKELURAHAN_ID,
			TBLDAFTHOTEL.TBLDAFTHOTEL_PAJAKPERIKSA AS pokok,
			TBLDAFTHOTEL.TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR,
			TBLDAFTHOTEL.PAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_DENDAKRGBAYAR AS denda,
			TBLDAFTHOTEL.BAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BUNGAKRGBAYAR AS bunga,
			TBLDAFTHOTEL.TBLDAFTHOTEL_KENAIKANKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTHOTEL
			INNER JOIN TBLDAFTAR ON TBLDAFTHOTEL.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTHOTEL.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTHOTEL.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTHOTEL.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHOTEL.TBLDAFTAR_GOLONGAN,
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK,
			TBLDAFTHOTEL.TBLKECAMATAN_ID,
			TBLDAFTHOTEL.TBLKELURAHAN_ID,
			TBLDAFTHOTEL.TBLDAFTHOTEL_PAJAKPERIKSA,
			TBLDAFTHOTEL.TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR,
			TBLDAFTHOTEL.PAKB,
			TBLDAFTHOTEL_DENDAKRGBAYAR,
			TBLDAFTHOTEL.BAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BUNGAKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_KENAIKANKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($hotel)->queryAll();
		}

		elseif ($AYAT=='4.1.1.2.0'){
			$data['judul'] = 'PAJAK RESTORAN';
			$makan="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTRMAKAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTRMAKAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK,
			TBLDAFTRMAKAN.TBLKECAMATAN_ID,
			TBLDAFTRMAKAN.TBLKELURAHAN_ID,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_PAJAKPERIKSA AS pokok,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_THNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BLNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_TGLKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR,
			TBLDAFTRMAKAN.PAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_DENDAKRGBAYAR AS denda,
			TBLDAFTRMAKAN.BAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BUNGAKRGBAYAR AS bunga,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_KENAIKANKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTRMAKAN
			INNER JOIN TBLDAFTAR ON TBLDAFTRMAKAN.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTRMAKAN.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTRMAKAN.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTRMAKAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTRMAKAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK,
			TBLDAFTRMAKAN.TBLKECAMATAN_ID,
			TBLDAFTRMAKAN.TBLKELURAHAN_ID,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_PAJAKPERIKSA,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_THNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BLNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_TGLKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR,
			TBLDAFTRMAKAN.PAKB,
			TBLDAFTRMAKAN_DENDAKRGBAYAR,
			TBLDAFTRMAKAN.BAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BUNGAKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_KENAIKANKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($makan)->queryAll();
		}

		elseif ($AYAT=='4.1.1.3.0'){
			$data['judul'] = 'PAJAK HIBURAN';
			$hiburan="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTHIBURAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHIBURAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK,
			TBLDAFTHIBURAN.TBLKECAMATAN_ID,
			TBLDAFTHIBURAN.TBLKELURAHAN_ID,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_PAJAKPERIKSA AS pokok,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_THNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BLNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_TGLKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR,
			TBLDAFTHIBURAN.PAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_DENDAKRGBAYAR AS denda,
			TBLDAFTHIBURAN.BAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BUNGAKRGBAYAR AS bunga,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_KENAIKANKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTHIBURAN
			INNER JOIN TBLDAFTAR ON TBLDAFTHIBURAN.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTHIBURAN.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTHIBURAN.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTHIBURAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHIBURAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK,
			TBLDAFTHIBURAN.TBLKECAMATAN_ID,
			TBLDAFTHIBURAN.TBLKELURAHAN_ID,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_PAJAKPERIKSA,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_THNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BLNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_TGLKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR,
			TBLDAFTHIBURAN.PAKB,
			TBLDAFTHIBURAN_DENDAKRGBAYAR,
			TBLDAFTHIBURAN.BAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BUNGAKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_KENAIKANKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($hiburan)->queryAll();
		}

		elseif($AYAT=='4.1.1.4.0'){
			$data['judul'] = 'PAJAK REKLAME';
			$reklame="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK,
			TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTREKLAME.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTREKLAME.TBLDAFTAR_GOLONGAN,
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK,
			TBLDAFTREKLAME.TBLKECAMATAN_ID,
			TBLDAFTREKLAME.TBLKELURAHAN_ID,
			TBLDAFTREKLAME.TBLDAFTREKLAME_PAJAKPERIKSA AS pokok,
			TBLDAFTREKLAME.TBLDAFTREKLAME_THNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BLNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_TGLKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR,
			TBLDAFTREKLAME.PAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_DENDAKRGBAYAR AS denda,
			TBLDAFTREKLAME.BAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BUNGAKRGBAYAR AS bunga,
			TBLDAFTREKLAME.TBLDAFTREKLAME_KENAIKANKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTREKLAME
			INNER JOIN TBLDAFTAR ON TBLDAFTREKLAME.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTREKLAME.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTREKLAME.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK,
			TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTREKLAME.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTREKLAME.TBLDAFTAR_GOLONGAN,
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK,
			TBLDAFTREKLAME.TBLKECAMATAN_ID,
			TBLDAFTREKLAME.TBLKELURAHAN_ID,
			TBLDAFTREKLAME.TBLDAFTREKLAME_PAJAKPERIKSA,
			TBLDAFTREKLAME.TBLDAFTREKLAME_THNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BLNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_TGLKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR,
			TBLDAFTREKLAME.PAKB,
			TBLDAFTREKLAME_DENDAKRGBAYAR,
			TBLDAFTREKLAME.BAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BUNGAKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_KENAIKANKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($reklame)->queryAll();
		}

		elseif($AYAT=='4.1.1.7.0'){
			$data['judul'] = 'PAJAK PARKIR';
			$parkir="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK,
			TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTPARKIR.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTPARKIR.TBLDAFTAR_GOLONGAN,
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK,
			TBLDAFTPARKIR.TBLKECAMATAN_ID,
			TBLDAFTPARKIR.TBLKELURAHAN_ID,
			TBLDAFTPARKIR.TBLDAFTPARKIR_PAJAKPERIKSA AS pokok,
			TBLDAFTPARKIR.TBLDAFTPARKIR_THNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BLNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_TGLKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR,
			TBLDAFTPARKIR.PAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_DENDAKRGBAYAR AS denda,
			TBLDAFTPARKIR.BAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BUNGAKRGBAYAR AS bunga,
			TBLDAFTPARKIR.TBLDAFTPARKIR_KENAIKANKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTPARKIR
			INNER JOIN TBLDAFTAR ON TBLDAFTPARKIR.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTPARKIR.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTPARKIR.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK,
			TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTPARKIR.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTPARKIR.TBLDAFTAR_GOLONGAN,
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK,
			TBLDAFTPARKIR.TBLKECAMATAN_ID,
			TBLDAFTPARKIR.TBLKELURAHAN_ID,
			TBLDAFTPARKIR.TBLDAFTPARKIR_PAJAKPERIKSA,
			TBLDAFTPARKIR.TBLDAFTPARKIR_THNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BLNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_TGLKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR,
			TBLDAFTPARKIR.PAKB,
			TBLDAFTPARKIR_DENDAKRGBAYAR,
			TBLDAFTPARKIR.BAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BUNGAKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_KENAIKANKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($parkir)->queryAll();
		}

		elseif($AYAT=='4.1.1.8.0'){
			$data['judul'] = 'PAJAK AIR TANAH';
			$tanah="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK,
			TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTTANAH.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTTANAH.TBLDAFTAR_GOLONGAN,
			TBLDAFTTANAH.TBLDAFTAR_NOPOK,
			TBLDAFTTANAH.TBLKECAMATAN_ID,
			TBLDAFTTANAH.TBLKELURAHAN_ID,
			TBLDAFTTANAH.TBLDAFTTANAH_PAJAKPERIKSA AS pokok,
			TBLDAFTTANAH.TBLDAFTTANAH_THNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_BLNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_TGLKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR,
			TBLDAFTTANAH.PAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_DENDAKRGBAYAR AS denda,
			TBLDAFTTANAH.BAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_BUNGAKRGBAYAR AS bunga,
			TBLDAFTTANAH.TBLDAFTTANAH_KENAIKANKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTTANAH
			INNER JOIN TBLDAFTAR ON TBLDAFTTANAH.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTTANAH.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTTANAH.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTTANAH.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK,
			TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTTANAH.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTTANAH.TBLDAFTAR_GOLONGAN,
			TBLDAFTTANAH.TBLDAFTAR_NOPOK,
			TBLDAFTTANAH.TBLKECAMATAN_ID,
			TBLDAFTTANAH.TBLKELURAHAN_ID,
			TBLDAFTTANAH.TBLDAFTTANAH_PAJAKPERIKSA,
			TBLDAFTTANAH.TBLDAFTTANAH_THNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_BLNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_TGLKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR,
			TBLDAFTTANAH.PAKB,
			TBLDAFTTANAH_DENDAKRGBAYAR,
			TBLDAFTTANAH.BAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_BUNGAKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_KENAIKANKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTTANAH.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($tanah)->queryAll();
		}

		elseif($AYAT=='4.1.1.9.0'){
			$data['judul'] = 'PAJAK SARANG BURUNG WALET';
			$burung="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK,
			TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTBURUNG.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTBURUNG.TBLDAFTAR_GOLONGAN,
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK,
			TBLDAFTBURUNG.TBLKECAMATAN_ID,
			TBLDAFTBURUNG.TBLKELURAHAN_ID,
			TBLDAFTBURUNG.TBLDAFTBURUNG_PAJAKPERIKSA AS pokok,
			TBLDAFTBURUNG.TBLDAFTBURUNG_THNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BLNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_TGLKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR,
			TBLDAFTBURUNG.PAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_DENDAKRGBAYAR AS denda,
			TBLDAFTBURUNG.BAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BUNGAKRGBAYAR AS bunga,
			TBLDAFTBURUNG.TBLDAFTBURUNG_KENAIKANKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTBURUNG
			INNER JOIN TBLDAFTAR ON TBLDAFTBURUNG.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTBURUNG.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTBURUNG.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK,
			TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTBURUNG.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTBURUNG.TBLDAFTAR_GOLONGAN,
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK,
			TBLDAFTBURUNG.TBLKECAMATAN_ID,
			TBLDAFTBURUNG.TBLKELURAHAN_ID,
			TBLDAFTBURUNG.TBLDAFTBURUNG_PAJAKPERIKSA,
			TBLDAFTBURUNG.TBLDAFTBURUNG_THNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BLNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_TGLKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR,
			TBLDAFTBURUNG.PAKB,
			TBLDAFTBURUNG_DENDAKRGBAYAR,
			TBLDAFTBURUNG.BAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BUNGAKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_KENAIKANKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cari'] = $cari = Yii::app()->db->createCommand($tanah)->queryAll();
		}

		$this->renderPartial('tabel_laporan',array('data'=>$data));
	}

	public function actionCetak()
	{
		$TBLREKENING_KODE = $_REQUEST['TBLREKENING_KODE'];
		$tahun = substr($_REQUEST['tahun'], -2);
		$nopok = $_REQUEST['nopok'];

		$AYAT = $_REQUEST['TBLREKENING_KODE'];

		if($AYAT=='4.1.1.1.0'){
		$data['judul'] = 'PAJAK HOTEL';
			$hotel="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTHOTEL.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHOTEL.TBLDAFTAR_GOLONGAN,
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK,
			TBLDAFTHOTEL.TBLKECAMATAN_ID,
			TBLDAFTHOTEL.TBLKELURAHAN_ID,
			TBLDAFTHOTEL.TBLDAFTHOTEL_PAJAKPERIKSA AS pokok,
			TBLDAFTHOTEL.TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR,
			TBLDAFTHOTEL.PAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_DENDAKRGBAYAR AS denda,
			TBLDAFTHOTEL.BAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BUNGAKRGBAYAR AS bunga,
			TBLDAFTHOTEL.TBLDAFTHOTEL_KENAIKANKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTHOTEL
			INNER JOIN TBLDAFTAR ON TBLDAFTHOTEL.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTHOTEL.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTHOTEL.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTHOTEL.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHOTEL.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTHOTEL.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHOTEL.TBLDAFTAR_GOLONGAN,
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK,
			TBLDAFTHOTEL.TBLKECAMATAN_ID,
			TBLDAFTHOTEL.TBLKELURAHAN_ID,
			TBLDAFTHOTEL.TBLDAFTHOTEL_PAJAKPERIKSA,
			TBLDAFTHOTEL.TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_REGKURANGBAYAR,
			TBLDAFTHOTEL.PAKB,
			TBLDAFTHOTEL_DENDAKRGBAYAR,
			TBLDAFTHOTEL.BAKB,
			TBLDAFTHOTEL.TBLDAFTHOTEL_BUNGAKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_KENAIKANKRGBAYAR,
			TBLDAFTHOTEL.TBLDAFTHOTEL_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTHOTEL.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($hotel)->queryAll();
		}

		elseif ($AYAT=='4.1.1.2.0'){
		$data['judul'] = 'PAJAK RESTORAN';
			$makan="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTRMAKAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTRMAKAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK,
			TBLDAFTRMAKAN.TBLKECAMATAN_ID,
			TBLDAFTRMAKAN.TBLKELURAHAN_ID,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_PAJAKPERIKSA AS pokok,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_THNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BLNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_TGLKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR,
			TBLDAFTRMAKAN.PAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_DENDAKRGBAYAR AS denda,
			TBLDAFTRMAKAN.BAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BUNGAKRGBAYAR AS bunga,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_KENAIKANKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTRMAKAN
			INNER JOIN TBLDAFTAR ON TBLDAFTRMAKAN.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTRMAKAN.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTRMAKAN.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTRMAKAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTRMAKAN.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTRMAKAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTRMAKAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK,
			TBLDAFTRMAKAN.TBLKECAMATAN_ID,
			TBLDAFTRMAKAN.TBLKELURAHAN_ID,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_PAJAKPERIKSA,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_THNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BLNKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_TGLKURANGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_REGKURANGBAYAR,
			TBLDAFTRMAKAN.PAKB,
			TBLDAFTRMAKAN_DENDAKRGBAYAR,
			TBLDAFTRMAKAN.BAKB,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_BUNGAKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_KENAIKANKRGBAYAR,
			TBLDAFTRMAKAN.TBLDAFTRMAKAN_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTRMAKAN.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($makan)->queryAll();
		}

		elseif ($AYAT=='4.1.1.3.0'){
		$data['judul'] = 'PAJAK HIBURAN';
			$hiburan="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTHIBURAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHIBURAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK,
			TBLDAFTHIBURAN.TBLKECAMATAN_ID,
			TBLDAFTHIBURAN.TBLKELURAHAN_ID,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_PAJAKPERIKSA AS pokok,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_THNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BLNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_TGLKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR,
			TBLDAFTHIBURAN.PAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_DENDAKRGBAYAR AS denda,
			TBLDAFTHIBURAN.BAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BUNGAKRGBAYAR AS bunga,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_KENAIKANKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTHIBURAN
			INNER JOIN TBLDAFTAR ON TBLDAFTHIBURAN.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTHIBURAN.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTHIBURAN.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTHIBURAN.TBLPENDATAAN_THNPAJAK,
			TBLDAFTHIBURAN.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTHIBURAN.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTHIBURAN.TBLDAFTAR_GOLONGAN,
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK,
			TBLDAFTHIBURAN.TBLKECAMATAN_ID,
			TBLDAFTHIBURAN.TBLKELURAHAN_ID,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_PAJAKPERIKSA,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_THNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BLNKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_TGLKURANGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_REGKURANGBAYAR,
			TBLDAFTHIBURAN.PAKB,
			TBLDAFTHIBURAN_DENDAKRGBAYAR,
			TBLDAFTHIBURAN.BAKB,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_BUNGAKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_KENAIKANKRGBAYAR,
			TBLDAFTHIBURAN.TBLDAFTHIBURAN_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTHIBURAN.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($hiburan)->queryAll();
		}

		elseif($AYAT=='4.1.1.4.0'){
		$data['judul'] = 'PAJAK REKLAME';
			$reklame="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK,
			TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTREKLAME.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTREKLAME.TBLDAFTAR_GOLONGAN,
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK,
			TBLDAFTREKLAME.TBLKECAMATAN_ID,
			TBLDAFTREKLAME.TBLKELURAHAN_ID,
			TBLDAFTREKLAME.TBLDAFTREKLAME_PAJAKPERIKSA AS pokok,
			TBLDAFTREKLAME.TBLDAFTREKLAME_THNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BLNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_TGLKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR,
			TBLDAFTREKLAME.PAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_DENDAKRGBAYAR AS denda,
			TBLDAFTREKLAME.BAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BUNGAKRGBAYAR AS bunga,
			TBLDAFTREKLAME.TBLDAFTREKLAME_KENAIKANKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTREKLAME
			INNER JOIN TBLDAFTAR ON TBLDAFTREKLAME.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTREKLAME.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTREKLAME.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTREKLAME.TBLPENDATAAN_THNPAJAK,
			TBLDAFTREKLAME.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTREKLAME.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTREKLAME.TBLDAFTAR_GOLONGAN,
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK,
			TBLDAFTREKLAME.TBLKECAMATAN_ID,
			TBLDAFTREKLAME.TBLKELURAHAN_ID,
			TBLDAFTREKLAME.TBLDAFTREKLAME_PAJAKPERIKSA,
			TBLDAFTREKLAME.TBLDAFTREKLAME_THNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BLNKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_TGLKURANGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_REGKURANGBAYAR,
			TBLDAFTREKLAME.PAKB,
			TBLDAFTREKLAME_DENDAKRGBAYAR,
			TBLDAFTREKLAME.BAKB,
			TBLDAFTREKLAME.TBLDAFTREKLAME_BUNGAKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_KENAIKANKRGBAYAR,
			TBLDAFTREKLAME.TBLDAFTREKLAME_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTREKLAME.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($reklame)->queryAll();
		}

		elseif($AYAT=='4.1.1.7.0'){
		$data['judul'] = 'PAJAK PARKIR';
			$parkir="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK,
			TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTPARKIR.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTPARKIR.TBLDAFTAR_GOLONGAN,
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK,
			TBLDAFTPARKIR.TBLKECAMATAN_ID,
			TBLDAFTPARKIR.TBLKELURAHAN_ID,
			TBLDAFTPARKIR.TBLDAFTPARKIR_PAJAKPERIKSA AS pokok,
			TBLDAFTPARKIR.TBLDAFTPARKIR_THNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BLNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_TGLKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR,
			TBLDAFTPARKIR.PAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_DENDAKRGBAYAR AS denda,
			TBLDAFTPARKIR.BAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BUNGAKRGBAYAR AS bunga,
			TBLDAFTPARKIR.TBLDAFTPARKIR_KENAIKANKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTPARKIR
			INNER JOIN TBLDAFTAR ON TBLDAFTPARKIR.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTPARKIR.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTPARKIR.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTPARKIR.TBLPENDATAAN_THNPAJAK,
			TBLDAFTPARKIR.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTPARKIR.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTPARKIR.TBLDAFTAR_GOLONGAN,
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK,
			TBLDAFTPARKIR.TBLKECAMATAN_ID,
			TBLDAFTPARKIR.TBLKELURAHAN_ID,
			TBLDAFTPARKIR.TBLDAFTPARKIR_PAJAKPERIKSA,
			TBLDAFTPARKIR.TBLDAFTPARKIR_THNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BLNKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_TGLKURANGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_REGKURANGBAYAR,
			TBLDAFTPARKIR.PAKB,
			TBLDAFTPARKIR_DENDAKRGBAYAR,
			TBLDAFTPARKIR.BAKB,
			TBLDAFTPARKIR.TBLDAFTPARKIR_BUNGAKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_KENAIKANKRGBAYAR,
			TBLDAFTPARKIR.TBLDAFTPARKIR_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTPARKIR.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($parkir)->queryAll();
		}

		elseif($AYAT=='4.1.1.8.0'){
		$data['judul'] = 'PAJAK AIR TANAH';
			$tanah="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK,
			TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTTANAH.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTTANAH.TBLDAFTAR_GOLONGAN,
			TBLDAFTTANAH.TBLDAFTAR_NOPOK,
			TBLDAFTTANAH.TBLKECAMATAN_ID,
			TBLDAFTTANAH.TBLKELURAHAN_ID,
			TBLDAFTTANAH.TBLDAFTTANAH_PAJAKPERIKSA AS pokok,
			TBLDAFTTANAH.TBLDAFTTANAH_THNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_BLNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_TGLKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR,
			TBLDAFTTANAH.PAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_DENDAKRGBAYAR AS denda,
			TBLDAFTTANAH.BAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_BUNGAKRGBAYAR AS bunga,
			TBLDAFTTANAH.TBLDAFTTANAH_KENAIKANKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTTANAH
			INNER JOIN TBLDAFTAR ON TBLDAFTTANAH.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTTANAH.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTTANAH.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTTANAH.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTTANAH.TBLPENDATAAN_THNPAJAK,
			TBLDAFTTANAH.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTTANAH.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTTANAH.TBLDAFTAR_GOLONGAN,
			TBLDAFTTANAH.TBLDAFTAR_NOPOK,
			TBLDAFTTANAH.TBLKECAMATAN_ID,
			TBLDAFTTANAH.TBLKELURAHAN_ID,
			TBLDAFTTANAH.TBLDAFTTANAH_PAJAKPERIKSA,
			TBLDAFTTANAH.TBLDAFTTANAH_THNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_BLNKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_TGLKURANGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_REGKURANGBAYAR,
			TBLDAFTTANAH.PAKB,
			TBLDAFTTANAH_DENDAKRGBAYAR,
			TBLDAFTTANAH.BAKB,
			TBLDAFTTANAH.TBLDAFTTANAH_BUNGAKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_KENAIKANKRGBAYAR,
			TBLDAFTTANAH.TBLDAFTTANAH_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTTANAH.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($tanah)->queryAll();
		}

		elseif($AYAT=='4.1.1.9.0'){
		$data['judul'] = 'PAJAK SARANG BURUNG WALET';
			$burung="SELECT
			*
			FROM
			(
			SELECT
			TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK,
			TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHANAMA,
			TBLDAFTAR.TBLDAFTAR_BADANUSAHAALAMAT,
			TBLDAFTBURUNG.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTBURUNG.TBLDAFTAR_GOLONGAN,
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK,
			TBLDAFTBURUNG.TBLKECAMATAN_ID,
			TBLDAFTBURUNG.TBLKELURAHAN_ID,
			TBLDAFTBURUNG.TBLDAFTBURUNG_PAJAKPERIKSA AS pokok,
			TBLDAFTBURUNG.TBLDAFTBURUNG_THNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BLNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_TGLKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR,
			TBLDAFTBURUNG.PAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_DENDAKRGBAYAR AS denda,
			TBLDAFTBURUNG.BAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BUNGAKRGBAYAR AS bunga,
			TBLDAFTBURUNG.TBLDAFTBURUNG_KENAIKANKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_RUPIAHKRGBAYAR AS total,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR
			ELSE
			0
			END
			) AS tunai,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 1 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang1,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 2 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang2,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 3 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang3,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 4 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang4,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 5 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang5,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 6 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang6,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 7 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang7,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 8 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang8,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 9 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang9,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 10 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang10,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 11 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang11,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A'
			AND TBLSETOR.TBLPENDATAAN_PAJAKKE = 12 THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			ELSE
			0
			END
			) AS ang12,
			SUM (
			CASE
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'A' THEN
			NVL (TBLSETOR.TBLSETOR_RUPIAHSETOR, 0) + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0) + NVL (TBLSETOR.NAIK, 0)
			WHEN TBLSETOR.TBLSETOR_JNSKETETAPAN = 'K' THEN
			TBLSETOR.TBLSETOR_RUPIAHSETOR + NVL (TBLSETOR.TBLSETOR_BUNGAKETETAPAN, 0) + NVL (TBLSETOR.TBLSETOR_DENDAKETETAPAN, 0)
			ELSE
			0
			END
			) AS totalangsur
			FROM
			TBLDAFTBURUNG
			INNER JOIN TBLDAFTAR ON TBLDAFTBURUNG.TBLDAFTAR_NOPOK = TBLDAFTAR.TBLDAFTAR_NOPOK
			LEFT JOIN TBLSETOR ON TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK = TBLSETOR.TBLPENDATAAN_THNPAJAK
			AND TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK = TBLSETOR.TBLPENDATAAN_BLNPAJAK
			AND TBLDAFTBURUNG.TBLPENDATAAN_TGLPAJAK = TBLSETOR.TBLPENDATAAN_TGLPAJAK
			AND TBLDAFTBURUNG.TBLDAFTAR_NOPOK = TBLSETOR.TBLDAFTAR_NOPOK
			AND (TBLSETOR_JNSKETETAPAN = 'K' OR TBLSETOR_JNSKETETAPAN = 'A')
			AND NVL (TBLSETOR.TBLSETOR_REKPAJAK, 0) = 1
			WHERE
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK IS NOT NULL
			AND TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR IS NOT NULL
			GROUP BY
			TBLDAFTBURUNG.TBLPENDATAAN_THNPAJAK,
			TBLDAFTBURUNG.TBLPENDATAAN_BLNPAJAK,
			tbldaftar_badanusahanama,
			tbldaftar_badanusahaalamat,
			TBLDAFTBURUNG.TBLDAFTAR_JNSPENDAPATAN,
			TBLDAFTBURUNG.TBLDAFTAR_GOLONGAN,
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK,
			TBLDAFTBURUNG.TBLKECAMATAN_ID,
			TBLDAFTBURUNG.TBLKELURAHAN_ID,
			TBLDAFTBURUNG.TBLDAFTBURUNG_PAJAKPERIKSA,
			TBLDAFTBURUNG.TBLDAFTBURUNG_THNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BLNKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_TGLKURANGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_REGKURANGBAYAR,
			TBLDAFTBURUNG.PAKB,
			TBLDAFTBURUNG_DENDAKRGBAYAR,
			TBLDAFTBURUNG.BAKB,
			TBLDAFTBURUNG.TBLDAFTBURUNG_BUNGAKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_KENAIKANKRGBAYAR,
			TBLDAFTBURUNG.TBLDAFTBURUNG_RUPIAHKRGBAYAR
			ORDER BY
			TBLDAFTBURUNG.TBLDAFTAR_NOPOK
			)
			WHERE
			TBLDAFTHOTEL_THNKURANGBAYAR = '$tahun'
			AND TBLDAFTAR_NOPOK = '$nopok'
			AND TOTALANGSUR < TOTAL
			ORDER BY
			TBLDAFTHOTEL_THNKURANGBAYAR,
			TBLDAFTHOTEL_BLNKURANGBAYAR,
			TBLDAFTHOTEL_TGLKURANGBAYAR,
			TBLDAFTAR_NOPOK";
			$data['cetak'] = $cetak = Yii::app()->db->createCommand($tanah)->queryAll();
		}

		if (isset($_REQUEST['jenis']) AND ($_REQUEST['jenis'])=='excel') {
			header('Content-Type: application/excel');
			header("Content-Disposition: attachment;Filename=Cetak-Jenis.xls");
		}
		$this->renderPartial('cetak',array('data'=>$data));
	}
	// Uncomment the following methods and override them if needed
	/*
	public function filters()
	{
		// return the filter configuration for this controller, e.g.:
		return array(
			'inlineFilterName',
			array(
				'class'=>'path.to.FilterClass',
				'propertyName'=>'propertyValue',
			),
		);
	}

	public function actions()
	{
		// return external action classes, e.g.:
		return array(
			'action1'=>'path.to.ActionClass',
			'action2'=>array(
				'class'=>'path.to.AnotherActionClass',
				'propertyName'=>'propertyValue',
			),
		);
	}
	*/
}